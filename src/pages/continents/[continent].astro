---
import { POSITION_NAME_MAP } from "@constants/worldMapConstants";
import BtnSelectorCity from "src/components/BtnSelectorCity.astro";
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";
import MainLayout from "src/layouts/MainLayout.astro";
export async function getStaticPaths(){
    return Object.entries(POSITION_NAME_MAP).map(([key, {continentImg, abbr}],index, array)=>{
        const lastCity = array[index-1]?.[1].abbr;
        const nextCity = array[index+1]?.[1].abbr;
        return {
            params:{continent:abbr},
            props: {continentImg, continentName: key, lastCity, nextCity}
        }
    })
}
const {continentImg, continentName, lastCity, nextCity} = Astro.props;
const images = import.meta.glob<{default:ImageMetadata}>("/src/assets/images/continents/*.{jpeg,jpg,png,gif}")
const imgPath = `/src/assets/images/continents/${continentImg}.png`
if(!images[imgPath]) throw new Error(`${imgPath} does not exist :(`)
const loremIpsum = [
    {test:"hola", test1:"hola"},
    {test:"hola", test1:"hola"},
    {test:"hola", test1:"hola"},
    {test:"hola", test1:"hola"},
]
---
<MainLayout title={continentName}>
    <article class="main--body">
        <div class="secondary--block">
            <Image
                src={images[imgPath]()}
                alt="continent"
                class="main--img"
            />
        </div>
        <div class="secondary--block">
            <div class="header--bar">
                <div class="card--ctn">
                    <div class="card--header">
                        {lastCity ? (<a href={`/continents/${lastCity}/`} class="btn--change">
                            <span class="material-icons-outlined icon--style">arrow_back</span>
                        </a>):<span></span>}
                        <p class="secondary--title header--elem">{continentName}</p>
                        {nextCity ? (<a href={`/continents/${nextCity}/`} class="btn--change">
                            <span class="material-icons-outlined icon--style">arrow_forward</span>
                        </a>):<span></span>}
                    </div>
                    <div class="card--body">
                        {loremIpsum.map((test)=>{
                            console.log(test)
                            return <BtnSelectorCity />
                        })}
                    </div>
                </div>
            </div>
        </div>
    </article>
</MainLayout>

<style>
    .card--body {
        /* background-color: red; */
        height: 100%;
        margin-bottom: 10%;
    }
    .main--body {
        display: flex;
        height: 100vh;
        flex-direction: row;
    }
    .main--img {
        max-width: 100%;
        height: auto;
    }
    .secondary--block {
        justify-content: center;
        align-items: center;
        display: flex;
        flex-grow: 0;
        width: 100%;
    }
    .secondary--title {
        font-family: "Segoe UI Regular";
        text-transform: capitalize;
        font-size: 3rem;
    }
    .header--bar {
        display: flex;
        width: 80%;
        height: 100%;
        align-items: flex-end;
    }
    .card--header{
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
    }
    .card--ctn {
        display: flex;
        flex-direction: column;
        align-content:flex-end;
        height: 80%;
        width: 100%;
    }
    .icon--style {
        font-size: 5rem;
    }
    .btn--change:visited {
        text-decoration: none;
        color:white
    }
    .header--elem {
        /* padding: 0;
        margin: 0; */

    }
    @media screen and (max-width:1000px){
        .main--body{
            flex-direction: column;
        }
        .secondary--title {
            font-size: 2rem;
        }
    }
</style>